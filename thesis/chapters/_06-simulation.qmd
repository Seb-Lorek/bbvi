---
bibliography: ["bib/references.bib", "bib/packages.bib"]
---

# Simulation study {#sec-sim}

Simulation studies are a crucial tool in the toolkit of a statistician, enabling the assessment of statistical properties, f.e. bias, due to knowing the underlying data generating process. Within this chapter, we will introduce and examine the outcomes of several simulation studies designed to explore various facets of BBVI. During the whole process of designing, conducting and presenting the study we follow the rationale of @Morris2019. The authors propose in their article  a structured approach denoted by the acronym ADEMP, which stands for Aims, Data-generating mechanisms, Estimands and other targets, Methods, and Performance measures [@Morris2019, p. 2074]. For each of the simulation studies, we will provide a overview of each of these aspects.

## Study design {#sec-study-d}

This section will be split up/ subsumed into to the individual simulation study sections. 

### Aims

- Illustrate the effectiveness of the BBVI algorithm by establishing that the parameters converge in a mean-square fashion to their true values within a frequentist context, for Bayesian linear regression and Bayesian logistic regression.
- Compare the posterior distributions of BBVI and MCMC via density plots.
- We aim to assess the comparative accuracy of BBVI against MCMC in approximating the posterior distribution over a predefined time window. This analysis will focus on location-scale regression, incorporating additive linear predictors.
- Compare the approximation of smooth functions and the related (gloabl) inverse smoothing parameters from BBVI and MCMC.

### Data generating mechanism 

- Generate random data set with different relationships in the linear predictors of interest.
- Start by generating random data for the regressor from a uniform distribution, parametrized by its minimum and maximum value. 
- After this we will generate the data for the linear predictors by applying functions on the random covariate vector, to model the additive structure in the linear predictor.
- Finally, conditional on the parameters of the response distribution we sample the response after applying the inverse link function on the additive linear predictor.

### Estimand/target of analysis 

- Start targeting estimands for fixed linear predictor specifications.
- Then we target the posterior distributions of MCMC and BBVI.
- Finally we target smooth functions and the corresponding direction of the (inverse) smoothing parameter. 

### Methods 

- Compare estimands to true fixed coefficients.
- Use kernel density plots as a visual tool and the Kullback-Leibler divergence as a formal measure to distinguish closeness to the "true" posterior.
- Compare estimated smooth functions to the true underlying function and assess the direction of the (inverse) smoothing parameter. 

### Performance measures

- Bias, EmpSE (also boxplots) and their related Monte Carlo SE.
- Kullback-Leibler divergence.
- MSE and its related Monte Carlo SE.

## Consistency study 

Show that the implementation of the BBVI algorithm results in consitent parameter estimates when considering the mean of the variational distribution. 

Discuss ADEMP for this study.

Show DGP.


![](assets/plots/plot8.pdf){width=80%}

![](assets/plots/plot9.pdf){width=80%}


![](assets/plots/plot10.pdf){width=80%}



## Posterior density study I

After that we study the posterior results from BBVI compared to MCMC for a simple Bayesian regression model.

## Posterior density study II

Now we will compare BBVI with MCMC for a location-scale regresion model in terms of the approximation measured by the KL-divergence.

## MSE study

Finally we will compare 